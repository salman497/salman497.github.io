"use strict";(self.webpackChunkng_demos=self.webpackChunkng_demos||[]).push([[363],{363:()=>{window.RevealChalkboard=window.RevealChalkboard||{id:"RevealChalkboard",init:function(u){Ke.call(this,u)},configure:function(u){configure(u)},toggleNotesCanvas:function(){toggleNotesCanvas()},toggleChalkboard:function(){toggleChalkboard()},colorIndex:function(){colorIndex()},colorNext:function(){colorNext()},colorPrev:function(){colorPrev()},clear:function(){clear()},reset:function(){reset()},resetAll:function(){resetAll()},updateStorage:function(){updateStorage()},getData:function(){return getData()},download:function(){download()}};var y=function Je(){var u;if(document.currentScript)u=document.currentScript.src;else{var V=document.querySelector('script[src$="/chalkboard/plugin.js"]');V&&(u=V.src)}return void 0===u?"":u.slice(0,u.lastIndexOf("/")+1)}();const Ke=function(u){var V=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){V=!0}}))}catch{}var T,M,Z,w=!1,me=3,be=7,we=1,ye=[!0,!1],A={src:y+"img/sponge.png",radius:20},z=[{color:"rgba(100,100,100,1)",cursor:"url("+y+"img/boardmarker-black.png), auto"},{color:"rgba(30,144,255, 1)",cursor:"url("+y+"img/boardmarker-blue.png), auto"},{color:"rgba(220,20,60,1)",cursor:"url("+y+"img/boardmarker-red.png), auto"},{color:"rgba(50,205,50,1)",cursor:"url("+y+"img/boardmarker-green.png), auto"},{color:"rgba(255,140,0,1)",cursor:"url("+y+"img/boardmarker-orange.png), auto"},{color:"rgba(150,0,20150,1)",cursor:"url("+y+"img/boardmarker-purple.png), auto"},{color:"rgba(255,220,0,1)",cursor:"url("+y+"img/boardmarker-yellow.png), auto"}],X=[{color:"rgba(255,255,255,0.5)",cursor:"url("+y+"img/chalk-white.png), auto"},{color:"rgba(96, 154, 244, 0.5)",cursor:"url("+y+"img/chalk-blue.png), auto"},{color:"rgba(237, 20, 28, 0.5)",cursor:"url("+y+"img/chalk-red.png), auto"},{color:"rgba(20, 237, 28, 0.5)",cursor:"url("+y+"img/chalk-green.png), auto"},{color:"rgba(220, 133, 41, 0.5)",cursor:"url("+y+"img/chalk-orange.png), auto"},{color:"rgba(220,0,220,0.5)",cursor:"url("+y+"img/chalk-purple.png), auto"},{color:"rgba(255,220,0,0.5)",cursor:"url("+y+"img/chalk-yellow.png), auto"}],ke={cursor:"url("+y+"img/sponge.png), auto"},te={toggleNotesCanvas:{keyCode:67,key:"C",description:"Toggle notes canvas"},toggleChalkboard:{keyCode:66,key:"B",description:"Toggle chalkboard"},clear:{keyCode:46,key:"DEL",description:"Clear drawings on slide"},resetAll:{keyCode:8,key:"BACKSPACE",description:"Reset all drawings"},colorNext:{keyCode:88,key:"X",description:"Next color"},colorPrev:{keyCode:89,key:"Y",description:"Previous color"},download:{keyCode:68,key:"D",description:"Download drawings"}},Ce="chalkboard",v=[0,0],H=!0,Ee=!0,F=800,D=!1,O="broadcast",S=Se(u.getConfig().chalkboard||{});if(S.keyBindings)for(var U in S.keyBindings)te[U]=S.keyBindings[U];function Se(e){return"whiteboard"===((e.boardmarkerWidth||e.penWidth)&&(me=e.boardmarkerWidth||e.penWidth),e.chalkWidth&&(be=e.chalkWidth),e.chalkEffect&&(we=e.chalkEffect),e.rememberColor&&(ye=e.rememberColor),e.eraser&&(A=e.eraser),e.boardmarkers&&(z=e.boardmarkers),e.chalks&&(X=e.chalks),e.theme&&(Ce=e.theme),Ce)?(T=["rgba(127,127,127,.1)",y+"img/whiteboard.png"],Z=[he,he],M=[z,z],w={color:"rgb(127,127,255,0.1)",distance:40,width:2}):(T=["rgba(127,127,127,.1)",y+"img/blackboard.png"],Z=[he,Re],M=[z,X],w={color:"rgb(50,50,10,0.5)",distance:80,width:2}),e.background&&(T=e.background),null!=e.grid&&(w=e.grid),null!=e.colorButtons&&(H=e.colorButtons),null!=e.boardHandle&&(Ee=e.boardHandle),e.transition&&(F=e.transition),null!=e.readOnly&&(D=e.readOnly),e.messageType&&(O=e.messageType),r&&(e.theme||e.background||e.grid)&&(document.getElementById(r[1].id).style.background='url("'+T[1]+'") repeat',C(1),Ae()),e}function Oe(e){document.querySelector("section[data-markdown]:not([data-markdown-parsed])")||document.querySelector("[data-load]:not([data-loaded])")||document.querySelector('code[data-line-numbers*="|"]')?(console.log("Wait for external sources to be loaded and code to be highlighted"),setTimeout(Oe,500,e)):e()}function De(e){null!==J?e():(console.log("Wait for drawings to be loaded"),setTimeout(De,500,e))}var r=[{id:"notescanvas"},{id:"chalkboard"}];xe(0),xe(1);var s=0,f=0,m=0,b=0,P=null,W=null,B=!1,Y=!1,g=Date.now(),I={h:0,v:0},ae=[[],[]],ce=null,re=null,N=!1;function G(e,t){e.style.cursor=t.cursor;var a=document.querySelector('.palette[data-mode="'+s+'"]');a&&(a.style.cursor=t.cursor)}function Le(e,t){(!0===t||t>e.length)&&(t=e.length);var a=document.createElement("div");a.classList.add("palette");for(var n=document.createElement("ul"),o=0;o<t;o++){var i=document.createElement("li");i.setAttribute("data-color",o),i.innerHTML='<i class="fa fa-square"></i>',i.style.color=e[o].color,i.addEventListener("click",function(h){for(var p=h.target;!p.hasAttribute("data-color");)p=p.parentElement;ee(parseInt(p.getAttribute("data-color")))}),i.addEventListener("touchstart",function(h){for(var p=h.target;!p.hasAttribute("data-color");)p=p.parentElement;ee(parseInt(p.getAttribute("data-color")))}),n.appendChild(i)}var l=document.createElement("li");l.setAttribute("data-eraser","true");var d=document.createElement("img");return d.src=A.src,d.height="24",d.width="24",d.style.marginTop="10px",d.style.marginRight="0",d.style.marginBottom="0",d.style.marginLeft="0",l.appendChild(d),l.addEventListener("click",function(h){ee(-1)}),l.addEventListener("touchstart",function(h){ee(-1)}),n.appendChild(l),a.appendChild(n),a}function ne(e){ie(e,!0);var t=new CustomEvent(O);t.content={sender:"chalkboard-plugin",type:"selectboard",timestamp:Date.now()-g,mode:s,board:f},document.dispatchEvent(t)}function xe(e){var t=document.createElement("div");if(t.id=r[e].id,t.classList.add("overlay"),t.setAttribute("data-prevent-swipe","true"),t.oncontextmenu=function(){return!1},G(t,M[e][v[e]]),r[e].width=window.innerWidth,r[e].height=window.innerHeight,r[e].scale=1,r[e].xOffset=0,r[e].yOffset=0,"0"==e){t.style.background="rgba(0,0,0,0)",t.style.zIndex=24,t.style.opacity=1,t.style.visibility="visible",t.style.pointerEvents="none",document.querySelector(".slides");var n=u.getConfig().width/u.getConfig().height;r[e].width>r[e].height*n?r[e].xOffset=(r[e].width-r[e].height*n)/2:r[e].height>r[e].width/n&&(r[e].yOffset=(r[e].height-r[e].width/n)/2),H&&((o=Le(z,H)).dataset.mode=e,o.style.visibility="hidden",t.appendChild(o))}else{var o;if(t.style.background='url("'+T[e]+'") repeat',t.style.zIndex=26,t.style.opacity=0,t.style.visibility="hidden",H&&((o=Le(X,H)).dataset.mode=e,t.appendChild(o)),Ee){var i=document.createElement("div");i.classList.add("boardhandle"),i.innerHTML='<ul><li><a id="previousboard" href="#" title="Previous board"><i class="fas fa-chevron-up"></i></a></li><li><a id="nextboard" href="#" title="Next board"><i class="fas fa-chevron-down"></i></a></li></ul>',i.querySelector("#previousboard").addEventListener("click",function(d){d.preventDefault(),ne(f-1)}),i.querySelector("#nextboard").addEventListener("click",function(d){d.preventDefault(),ne(f+1)}),i.querySelector("#previousboard").addEventListener("touchstart",function(d){d.preventDefault(),ne(f-1)}),i.querySelector("#nextboard").addEventListener("touchstart",function(d){d.preventDefault(),ne(f+1)}),t.appendChild(i)}}var l=document.createElement("canvas");l.width=r[e].width,l.height=r[e].height,l.setAttribute("data-chalkboard",e),G(l,M[e][v[e]]),t.appendChild(l),r[e].canvas=l,r[e].context=l.getContext("2d"),function st(e){e.addEventListener("touchstart",function(t){if(t.preventDefault(),!D&&t.target.getAttribute("data-chalkboard")==s){var a=r[s].scale,n=r[s].xOffset,o=r[s].yOffset,i=t.touches[0];m=i.pageX,b=i.pageY,v[s]<0?Pe((m-n)/a,(b-o)/a):Be((m-n)/a,(b-o)/a)}},!!V&&{passive:!1}),e.addEventListener("touchmove",function(t){if(t.preventDefault(),B||Y){var l,a=r[s].scale,n=r[s].xOffset,o=r[s].yOffset,i=t.touches[0];m=i.pageX,b=i.pageY,B?(ve((P-n)/a,(W-o)/a,(m-n)/a,(b-o)/a,v[s]),(l=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"draw",timestamp:Date.now()-g,mode:s,board:f,fromX:(P-n)/a,fromY:(W-o)/a,toX:(m-n)/a,toY:(b-o)/a,color:v[s]},document.dispatchEvent(l),P=m,W=b):(de((m-n)/a,(b-o)/a),(l=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-g,mode:s,board:f,x:(m-n)/a,y:(b-o)/a},document.dispatchEvent(l))}},!1),e.addEventListener("touchend",function(t){t.preventDefault(),Ie(),We()},!1),e.addEventListener("mousedown",function(t){if(t.preventDefault(),!D&&t.target.getAttribute("data-chalkboard")==s){var a=r[s].scale,n=r[s].xOffset,o=r[s].yOffset;if(m=t.pageX,b=t.pageY,v[s]<0||2==t.button||1==t.button){v[s]>=0&&G(r[s].canvas,ke),Pe((m-n)/a,(b-o)/a);var i=new CustomEvent(O);i.content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-g,mode:s,board:f,x:(m-n)/a,y:(b-o)/a},document.dispatchEvent(i)}else Be((m-n)/a,(b-o)/a)}}),e.addEventListener("mousemove",function(t){t.preventDefault();var i,a=r[s].scale,n=r[s].xOffset,o=r[s].yOffset;(m=t.pageX,b=t.pageY,B||Y)&&(a=r[s].scale,n=r[s].xOffset,o=r[s].yOffset,m=t.pageX,b=t.pageY,B?(ve((P-n)/a,(W-o)/a,(m-n)/a,(b-o)/a,v[s]),(i=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"draw",timestamp:Date.now()-g,mode:s,board:f,fromX:(P-n)/a,fromY:(W-o)/a,toX:(m-n)/a,toY:(b-o)/a,color:v[s]},document.dispatchEvent(i),P=m,W=b):(de((m-n)/a,(b-o)/a),(i=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"erase",timestamp:Date.now()-g,mode:s,board:f,x:(m-n)/a,y:(b-o)/a},document.dispatchEvent(i)))}),e.addEventListener("mouseup",function(t){t.preventDefault(),v[s]>=0&&G(r[s].canvas,M[s][v[s]]),(B||Y)&&(Ie(),We())})}(t),document.querySelector(".reveal").appendChild(t),r[e].container=t}var c=[{width:u.getConfig().width,height:u.getConfig().height,data:[]},{width:u.getConfig().width,height:u.getConfig().height,data:[]}],J=null;function Te(e){var t=!1;try{for(var a=JSON.parse(e),n=0;n<a.length;n++)(r[n].width!=a[n].width||r[n].height!=a[n].height)&&(r[n].scale=Math.min(r[n].width/a[n].width,r[n].height/a[n].height),r[n].xOffset=(r[n].width-a[n].width*r[n].scale)/2,r[n].yOffset=(r[n].height-a[n].height*r[n].scale)/2),S.readOnly&&(r[n].container.style.cursor="default",r[n].canvas.style.cursor="default");t=!0,c=a}catch{console.warn("Cannot initialise storage!")}return t}function ue(e){e?(K(),re=null):(re&&clearTimeout(re),re=setTimeout(ue,1e3,!0))}function K(){var e=JSON.stringify(c);return S.storage&&sessionStorage.setItem(S.storage,e),e}function Q(e){e.time=Date.now()-g,1==s&&(e.board=f);for(var t=_(),a=t.events.length;a>0&&e.time<t.events[a-1].time;)a--;t.events.splice(a,0,e),t.duration=Math.max(t.duration,Date.now()-g)+1,ue()}function Me(){for(var e=0;e<2;e++)for(var t=c[e].data.length-1;t>=0;t--)0==c[e].data[t].events.length&&c[e].data.splice(t,1);return K()}function _(e,t){null==t&&(t=s),e||(e=I);for(var n=0;n<c[t].data.length;n++)if(c[t].data[n].slide.h===e.h&&c[t].data[n].slide.v===e.v&&c[t].data[n].slide.f===e.f)return c[t].data[n];var o=Number(u.getCurrentSlide().getAttribute("data-pdf-page-number"));return c[t].data.push({slide:e,page:o,events:[],duration:0}),c[t].data[c[t].data.length-1]}function x(e){e||(e=I);for(var t=0,a=0;a<2;a++)for(var n=0;n<c[a].data.length;n++)if(c[a].data[n].slide.h===e.h&&c[a].data[n].slide.v===e.v&&c[a].data[n].slide.f===e.f){t=Math.max(t,c[a].data[n].duration);break}return t}S.storage&&(J=Te(sessionStorage.getItem(S.storage))),!J&&null!=S.src&&function $e(e){var t=new XMLHttpRequest;t.onload=function(){4===t.readyState&&404!=t.status?(J=Te(t.responseText),K(),console.log("Drawings loaded from file")):(S.readOnly=void 0,D=void 0,console.warn("Failed to get file "+e+". ReadyState: "+t.readyState+", Status: "+t.status),J=!1)},t.open("GET",e,!0);try{t.send()}catch(a){S.readOnly=void 0,D=void 0,console.warn("Failed to get file "+e+". Make sure that the presentation and the file are served by a HTTP server and the file can be found there. "+a),J=!1}}(S.src);var oe=/print-pdf/gi.test(window.location.search);function Ze(){for(var e=u.getSlides(),t=0,a=0;a<e.length;a++){e[a].setAttribute("data-pdf-page-number",t.toString());for(var n=e[a].querySelectorAll(".fragment:not([data-fragment-index])").length,o=e[a].querySelectorAll(".fragment[data-fragment-index]"),i=0;i<o.length;i++)Number(o[i].getAttribute("data-fragment-index"))+1>n&&(n=Number(o[i].getAttribute("data-fragment-index"))+1);t+=n+1}}function Xe(){if(0!=c[1].data.length){console.log("Create printout(s) for "+c[1].data.length+" slides"),r[0].container.style.opacity=0,r[0].container.style.visibility="hidden";var e=new Image;e.onload=function(){for(var t=u.getSlides(),a=c[1].data.length-1;a>=0;a--){console.log("Create printout for slide "+c[1].data[a].slide.h+"."+c[1].data[a].slide.v);var o=Ye(_(c[1].data[a].slide,1),e);je(t[c[1].data[a].page],o)}},e.src=T[1]}}function se(e,t,a){var n=t.findIndex(i=>i.board===a);if(-1===n){var o=function Fe(e){var t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.width,t.height=e.height,a.drawImage(e,0,0),t}(e);t.length?a<t[0].board?(n=0,t.unshift({board:a,canvas:o})):a>t[t.length-1].board&&(n=t.length,t.push({board:a,canvas:o})):(n=0,t.push({board:a,canvas:o}))}return t[n].canvas}function Ye(e,t){var a=u.getConfig().width,n=u.getConfig().height,o=1,i=0,l=0;(a!=c[1].width||n!=c[1].height)&&(o=Math.min(a/c[1].width,n/c[1].height),i=(a-c[1].width*o)/2,l=(n-c[1].height*o)/2),s=1,f=0;var d=[],h=document.createElement("canvas");h.width=a,h.height=n;var p=h.getContext("2d");p.fillStyle=p.createPattern(t,"repeat"),p.rect(0,0,a,n),p.fill();for(var k=0;k<e.events.length;k++)switch(e.events[k].type){case"draw":Z[1](se(h,d,f).getContext("2d"),i+e.events[k].x1*o,l+e.events[k].y1*o,i+e.events[k].x2*o,l+e.events[k].y2*o,l+e.events[k].color);break;case"erase":fe(se(h,d,f).getContext("2d"),i+e.events[k].x*o,l+e.events[k].y*o);break;case"selectboard":ie(e.events[k].board);break;case"clear":se(h,d,f).getContext("2d").clearRect(0,0,a,n),se(h,d,f).getContext("2d").fill()}return d=d.sort((E,pe)=>E.board>pe.board?1:-1),s=0,d}function je(e,t){for(var a=e.parentElement.parentElement,n=e.parentElement.nextElementSibling,o=0;o<t.length;o++){var i=document.createElement("div");i.classList.add("pdf-page"),i.style.height=u.getConfig().height,i.append(t[o].canvas),null!=n?a.insertBefore(i,n):a.append(i)}}function he(e,t,a,n,o,i){null==i&&(i=v[s]),e.lineWidth=me,e.lineCap="round",e.strokeStyle=z[i].color,e.beginPath(),e.moveTo(t,a),e.lineTo(n,o),e.stroke()}function Re(e,t,a,n,o,i){null==i&&(i=v[s]);var l=be;e.lineWidth=l,e.lineCap="round",e.fillStyle=X[i].color,e.strokeStyle=X[i].color,e.strokeStyle=e.strokeStyle.replace(/[\d\.]+\)$/g,"1)"),e.beginPath(),e.moveTo(t,a),e.lineTo(n,o),e.stroke();for(var h=Math.round(Math.sqrt(Math.pow(n-t,2)+Math.pow(o-a,2))/(5/l)),p=(n-t)/h,k=(o-a)/h,E=0;E<h;E++)if(we>.9*Math.random()){var ft=a+E*k,gt=t+E*p+(Math.random()-.5)*l*1.2,vt=ft+(Math.random()-.5)*l*1.2;e.clearRect(gt,vt,2*Math.random()+2,Math.random()+1)}}function fe(e,t,a){e.save(),e.beginPath(),e.arc(t+A.radius,a+A.radius,A.radius,0,2*Math.PI,!1),e.clip(),e.clearRect(t-1,a-1,2*A.radius+2,2*A.radius+2),e.restore(),1==s&&w&&function et(e,t,a){var n=r[1].context;r[1].scale=Math.min(r[1].width/c[1].width,r[1].height/c[1].height),r[1].xOffset=(r[1].width-c[1].width*r[1].scale)/2,r[1].yOffset=(r[1].height-c[1].height*r[1].scale)/2;for(var o=r[1].scale,d=w.distance*o,h=r[1].width/2-d/2-Math.floor((r[1].width-d)/2/d)*d,p=h+d*Math.ceil((e-a-h)/d);p<=h+d*Math.floor((e+a-h)/d);p+=d)n.beginPath(),n.lineWidth=w.width*o,n.lineCap="round",n.fillStyle=w.color,n.strokeStyle=w.color,n.moveTo(p,t-Math.sqrt(a*a-(e-p)*(e-p))),n.lineTo(p,t+Math.sqrt(a*a-(e-p)*(e-p))),n.stroke();for(var k=r[1].height/2-d/2-Math.floor((r[1].height-d)/2/d)*d,E=k+d*Math.ceil((t-a-k)/d);E<=k+d*Math.floor((t+a-k)/d);E+=d)n.beginPath(),n.lineWidth=w.width*o,n.lineCap="round",n.fillStyle=w.color,n.strokeStyle=w.color,n.moveTo(e-Math.sqrt(a*a-(t-E)*(t-E)),E),n.lineTo(e+Math.sqrt(a*a-(t-E)*(t-E)),E),n.stroke()}(t+A.radius,a+A.radius,A.radius)}function $(){r[1].container.style.opacity=1,r[1].container.style.visibility="visible",s=1}function L(){r[1].container.style.opacity=0,r[1].container.style.visibility="hidden",P=null,W=null,s=0}function C(e){0==e&&clearTimeout(ce),r[e].context.clearRect(0,0,r[e].width,r[e].height),1==e&&w&&Ae()}function Ae(){var e=r[1].context;r[1].scale=Math.min(r[1].width/c[1].width,r[1].height/c[1].height),r[1].xOffset=(r[1].width-c[1].width*r[1].scale)/2,r[1].yOffset=(r[1].height-c[1].height*r[1].scale)/2;for(var t=r[1].scale,o=w.distance*t,l=r[1].width/2-o/2-Math.floor((r[1].width-o)/2/o)*o;l<r[1].width;l+=o)e.beginPath(),e.lineWidth=w.width*t,e.lineCap="round",e.fillStyle=w.color,e.strokeStyle=w.color,e.moveTo(l,0),e.lineTo(l,r[1].height),e.stroke();for(var h=r[1].height/2-o/2-Math.floor((r[1].height-o)/2/o)*o;h<r[1].height;h+=o)e.beginPath(),e.lineWidth=w.width*t,e.lineCap="round",e.fillStyle=w.color,e.strokeStyle=w.color,e.moveTo(0,h),e.lineTo(r[1].width,h),e.stroke()}function j(e,t){e>=M[s].length&&(e=0),v[s]=e,G(r[s].canvas,v[s]<0?ke:M[s][v[s]])}function ie(e,t){f!=e&&(f=e,Ne(e),t&&Q({type:"selectboard"}))}function Ne(e){C(1);for(var t=_(I,1),a=0;a<t.events.length&&t.events[a].time<Date.now()-g;)e==t.events[a].board&&ge(1,t.events[a],Date.now()-g),a++}var le=[];function qe(){var e=le.shift();switch(g=Date.now()-e.content.timestamp,s<e.content.mode?$():s>e.content.mode&&L(),f!=e.content.board&&Ne(f=e.content.board),e.content.type){case"showChalkboard":$();break;case"closeChalkboard":L();break;case"erase":de(e.content.x,e.content.y);break;case"draw":ve(e.content.fromX,e.content.fromY,e.content.toX,e.content.toY,e.content.color);break;case"clear":ze();break;case"selectboard":ie(e.content.board,!0);break;case"resetSlide":Ue();break;case"init":c=e.content.storage;for(var t=0;t<2;t++)r[t].scale=Math.min(r[t].width/c[t].width,r[t].height/c[t].height),r[t].xOffset=(r[t].width-c[t].width*r[t].scale)/2,r[t].yOffset=(r[t].height-c[t].height*r[t].scale)/2;C(0),C(1),N||(ce=setTimeout(q,F,x(),0)),1==s&&0==e.content.mode&&setTimeout(L,F+50),0==s&&1==e.content.mode&&setTimeout($,F+50),s=e.content.mode,f=e.content.board}le.length>0?qe():ue()}function q(e,t){g=Date.now()-e,L(),s=0,f=0;for(var a=0;a<2;a++){C(a);for(var n=_(I,a),o=0;o<n.events.length&&n.events[o].time<Date.now()-g;)ge(a,n.events[o],e),o++;for(;N&&o<n.events.length;)ae[a].push(setTimeout(ge,n.events[o].time-(Date.now()-g),a,n.events[o],e)),o++}null!=t&&(s=t),1==s&&$()}function R(){for(var e=0;e<2;e++){for(var t=0;t<ae[e].length;t++)clearTimeout(ae[e][t]);ae[e]=[]}}function ge(e,t,a){switch(t.type){case"open":a<=t.time?$():s=1;break;case"close":a<t.time?L():s=0;break;case"clear":C(e);break;case"selectboard":ie(t.board);break;case"draw":!function nt(e,t,a){var o=r[e].scale,i=r[e].xOffset,l=r[e].yOffset;Z[e](r[e].context,i+t.x1*o,l+t.y1*o,i+t.x2*o,l+t.y2*o,t.color)}(e,t);break;case"erase":!function ot(e,t,a){var o=r[e].scale;fe(r[e].context,r[e].xOffset+t.x*o,r[e].yOffset+t.y*o)}(e,t)}}function Pe(e,t){B=!1,Y=!0,de(e,t)}function de(e,t){var a=r[s].context,n=r[s].scale,o=r[s].xOffset,i=r[s].yOffset;Q({type:"erase",x:e,y:t}),e*n+o>0&&t*n+i>0&&e*n+o<r[s].width&&t*n+i<r[s].height&&fe(a,e*n+o,t*n+i)}function We(){Y=!1}function Be(e,t){B=!0;var n=r[s].scale;P=e*n+r[s].xOffset,W=t*n+r[s].yOffset}function ve(e,t,a,n,o){var i=r[s].context,l=r[s].scale,d=r[s].xOffset,h=r[s].yOffset;Q({type:"draw",color:o,x1:e,y1:t,x2:a,y2:n}),e*l+d>0&&t*l+h>0&&e*l+d<r[s].width&&t*l+h<r[s].height&&a*l+d>0&&n*l+h>0&&a*l+d<r[s].width&&n*l+h<r[s].height&&Z[s](i,e*l+d,t*l+h,a*l+d,n*l+h,o)}function Ie(){B=!1}function it(){var e=Date.now()-g;N||(e=x());for(var t=0;t<2;t++)r[t].width=window.innerWidth,r[t].height=window.innerHeight,r[t].canvas.width=r[t].width,r[t].canvas.height=r[t].height,r[t].context.canvas.width=r[t].width,r[t].context.canvas.height=r[t].height,r[t].scale=Math.min(r[t].width/c[t].width,r[t].height/c[t].height),r[t].xOffset=(r[t].width-c[t].width*r[t].scale)/2,r[t].yOffset=(r[t].height-c[t].height*r[t].scale)/2;q(e,s)}function He(){if(1==s)D||Q({type:"close"}),L(),(e=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"closeChalkboard",timestamp:Date.now()-g,mode:0,board:f},document.dispatchEvent(e);else if($(),!D){var e;Q({type:"open"}),(e=new CustomEvent(O)).content={sender:"chalkboard-plugin",type:"showChalkboard",timestamp:Date.now()-g,mode:1,board:f},document.dispatchEvent(e);var t=0;ye[s]&&(t=v[s]),j(t)}}function ze(){Q({type:"clear"}),C(s)}function ee(e){D||j(e)}function Ue(){var e;g=Date.now(),L(),C(0),C(1),s=1,(e=_()).duration=0,e.events=[],s=0,(e=_()).duration=0,e.events=[],K()}function Ge(e){if(e||confirm("Please confirm to delete chalkboard drawings on this slide!")){R(),Ue();var a=new CustomEvent(O);a.content={sender:"chalkboard-plugin",type:"resetSlide",timestamp:Date.now()-g,mode:s,board:f},document.dispatchEvent(a)}}for(var U in document.addEventListener("received",function(e){e.content&&"chalkboard-plugin"==e.content.sender&&(le.push(e),console.log(JSON.stringify(e))),1==le.length&&qe()}),document.addEventListener("welcome",function(e){var t=new CustomEvent(O);t.content={sender:"chalkboard-plugin",recipient:e.id,type:"init",timestamp:Date.now()-g,storage:c,mode:s,board:f},document.dispatchEvent(t)}),document.addEventListener("seekplayback",function(e){R(),(!N||0==e.timestamp)&&q(e.timestamp)}),document.addEventListener("startplayback",function(e){R(),N=!0,q(e.timestamp)}),document.addEventListener("stopplayback",function(e){N=!1,R()}),document.addEventListener("startrecording",function(e){!function rt(){Ge(!0),g=Date.now()}()}),u.addEventListener("pdf-ready",function(e){De(Xe)}),u.addEventListener("ready",function(e){if(!oe){if(window.addEventListener("resize",it),g=Date.now()-x(),I=u.getIndices(),N||q(x(),0),u.isAutoSliding()){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}K(),Oe(Ze)}}),u.addEventListener("slidechanged",function(e){if(!oe&&(g=Date.now()-x(),I=u.getIndices(),L(),f=0,C(0),C(1),N||(ce=setTimeout(q,F,x(),0)),u.isAutoSliding())){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}}),u.addEventListener("fragmentshown",function(e){if(!oe)if(g=Date.now()-x(),I=u.getIndices(),L(),f=0,C(0),C(1),u.isAutoSliding()){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}else N||q(x(),0)}),u.addEventListener("fragmenthidden",function(e){oe||(g=Date.now()-x(),I=u.getIndices(),L(),f=0,C(0),C(1),u.isAutoSliding()?document.dispatchEvent(new CustomEvent("stopplayback")):N||(q(x()),L()))}),u.addEventListener("autoslideresumed",function(e){var t=new CustomEvent("startplayback");t.timestamp=0,document.dispatchEvent(t)}),u.addEventListener("autoslidepaused",function(e){document.dispatchEvent(new CustomEvent("stopplayback")),q(x(),0)}),this.toggleNotesCanvas=function lt(){if(!D)if(1==s)He(),notescanvas.style.background=T[0],notescanvas.style.pointerEvents="auto";else if("none"!=notescanvas.style.pointerEvents)H&&(notescanvas.querySelector(".palette").style.visibility="hidden"),notescanvas.style.background="rgba(0,0,0,0)",notescanvas.style.pointerEvents="none";else{H&&(notescanvas.querySelector(".palette").style.visibility="visible"),notescanvas.style.background=T[0],notescanvas.style.pointerEvents="auto";var e=0;v[s]&&(e=v[s]),j(e)}},this.toggleChalkboard=He,this.colorIndex=ee,this.colorNext=function ct(){D||j(function tt(){return v[s]=(v[s]+1)%M[s].length,v[s]}())},this.colorPrev=function ut(){D||j(function at(){return v[s]=(v[s]+(M[s].length-1))%M[s].length,v[s]}())},this.clear=function dt(){if(!D){ze();var e=new CustomEvent(O);e.content={sender:"chalkboard-plugin",type:"clear",timestamp:Date.now()-g,mode:s,board:f},document.dispatchEvent(e)}},this.reset=Ge,this.resetAll=function ht(e){if(e||confirm("Please confirm to delete all chalkboard drawings!")){R(),g=Date.now(),C(0),C(1),1==s&&L(),c=[{width:u.getConfig().width,height:u.getConfig().height,data:[]},{width:u.getConfig().width,height:u.getConfig().height,data:[]}],S.storage&&sessionStorage.setItem(S.storage,null);var a=new CustomEvent(O);a.content={sender:"chalkboard-plugin",type:"init",timestamp:Date.now()-g,storage:c,mode:s,board:f},document.dispatchEvent(a)}},this.download=function Ve(){var e=document.createElement("a");document.body.appendChild(e);try{e.download="chalkboard.json";var t=new Blob([Me()],{type:"application/json"});e.href=window.URL.createObjectURL(t)}catch(a){e.innerHTML+=" ("+a+")"}e.click(),document.body.removeChild(e)},this.updateStorage=K,this.getData=Me,this.configure=Se,te)te[U]&&u.addKeyBinding(te[U],RevealChalkboard[U]);return this}}}]);